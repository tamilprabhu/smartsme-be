"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5848],{5848:(A,f,d)=>{d.r(f),d.d(f,{OrderManagementModule:()=>X});var u=d(2200),c=d(7343),_=d(4341),M=d(8132),k=d(467),O=d(1413),v=d(9584),F=d(3294),x=d(6977),e=d(3664),s=d(2615),I=d(5035),b=d(9330),h=d(8810),p=d(9437),j=d(5312),y=d(8938),P=d(3067);let $=(()=>{var o;class a{constructor(r,t){this.http=r,this.loginService=t,this.API_URL=`${j.c.apiBaseUrl}/order`}getHeaders(){const r=this.loginService.getToken();return new b.Lr({"Content-Type":"application/json",Authorization:`Bearer ${r}`})}getOrders(r=1,t=y.R.TEN,n){let l=`${this.API_URL}?page=${r}&itemsPerPage=${t}`;return n&&n.trim()&&(l+=`&search=${encodeURIComponent(n.trim())}`),this.http.get(l,{headers:this.getHeaders()}).pipe((0,p.W)(m=>(0,h.$)(()=>m)))}getOrder(r){return this.http.get(`${this.API_URL}/${r}`,{headers:this.getHeaders()}).pipe((0,p.W)(t=>(0,h.$)(()=>t)))}createOrder(r){return this.http.post(this.API_URL,r,{headers:this.getHeaders()}).pipe((0,p.W)(t=>(0,h.$)(()=>t)))}updateOrder(r,t){return this.http.put(`${this.API_URL}/${r}`,t,{headers:this.getHeaders()}).pipe((0,p.W)(n=>(0,h.$)(()=>n)))}deleteOrder(r){return this.http.delete(`${this.API_URL}/${r}`,{headers:this.getHeaders()}).pipe((0,p.W)(t=>(0,h.$)(()=>t)))}static#e=o=()=>(this.\u0275fac=function(t){return new(t||a)(s.KVO(b.Qq),s.KVO(P.H))},this.\u0275prov=s.jDH({token:a,factory:a.\u0275fac,providedIn:"root"}))}return o(),a})();var S=d(6568),C=d(385);const B=["searchInput"];function R(o,a){if(1&o&&(e.j41(0,"ion-item",16)(1,"ion-label"),e.EFF(2," Found "),e.j41(3,"strong"),e.EFF(4),e.k0s(),e.EFF(5," order(s) "),e.k0s()()),2&o){const i=e.XpG();e.R7$(4),e.JRh(i.orders.length)}}function E(o,a){if(1&o){const i=e.RV6();e.j41(0,"ion-item",18)(1,"ion-label",19),e.bIt("click",function(){const t=s.eBV(i).$implicit,n=e.XpG(2);return s.Njj(n.openReadForm(t))}),e.j41(2,"h2"),e.EFF(3),e.j41(4,"ion-badge",20),e.EFF(5),e.k0s()(),e.j41(6,"p",21),e.EFF(7,"Product: "),e.j41(8,"strong"),e.EFF(9),e.k0s(),e.EFF(10," | Buyer: "),e.j41(11,"strong"),e.EFF(12),e.k0s()(),e.j41(13,"p",22),e.EFF(14),e.nI1(15,"date"),e.k0s()(),e.j41(16,"ion-buttons",23)(17,"ion-button",24),e.bIt("click",function(){const t=s.eBV(i).$implicit,n=e.XpG(2);return s.Njj(n.openUpdateForm(t))}),e.nrm(18,"ion-icon",25),e.k0s(),e.j41(19,"ion-button",26),e.bIt("click",function(){const t=s.eBV(i).$implicit,n=e.XpG(2);return s.Njj(n.confirmDelete(t))}),e.nrm(20,"ion-icon",27),e.k0s()()()}if(2&o){const i=a.$implicit;e.R7$(3),e.SpI("",i.orderName," "),e.R7$(),e.Y8G("color","completed"===i.orderStatus?"success":"pending"===i.orderStatus?"warning":"primary"),e.R7$(),e.SpI("#",i.orderId),e.R7$(4),e.JRh(i.prodId),e.R7$(3),e.JRh(i.buyerId),e.R7$(2),e.E5c("Quantity: ",i.orderQuantity," | Price: \u20b9",i.totalPrice," | Target: ",e.i5U(15,8,i.targetDate,"short"))}}function T(o,a){if(1&o&&(e.j41(0,"ion-list"),e.DNE(1,E,21,11,"ion-item",17),e.k0s()),2&o){const i=e.XpG();e.R7$(),e.Y8G("ngForOf",i.orders)}}function G(o,a){if(1&o&&(e.j41(0,"p"),e.EFF(1),e.k0s()),2&o){const i=e.XpG(2);e.R7$(),e.SpI('No orders match your search "',i.searchQuery,'"')}}function N(o,a){1&o&&(e.j41(0,"p"),e.EFF(1,"No orders available. Click the add button to create one."),e.k0s())}function D(o,a){if(1&o&&(e.j41(0,"ion-card",28)(1,"ion-card-header")(2,"ion-card-title"),e.EFF(3,"No Orders Found"),e.k0s()(),e.j41(4,"ion-card-content"),e.DNE(5,G,2,1,"p",11)(6,N,2,0,"p",11),e.k0s()()),2&o){const i=e.XpG();e.R7$(5),e.Y8G("ngIf",i.searchQuery),e.R7$(),e.Y8G("ngIf",!i.searchQuery&&0===i.orders.length)}}function U(o,a){if(1&o){const i=e.RV6();e.j41(0,"app-header",30),e.bIt("backClicked",function(){s.eBV(i);const t=e.XpG(2);return s.Njj(t.closeForm())}),e.k0s(),e.j41(1,"ion-content")(2,"p"),e.EFF(3,"Order Form - To be implemented"),e.k0s()()}if(2&o){const i=e.XpG(2);e.Y8G("title","create"===i.formMode?"Create Order":"update"===i.formMode?"Update Order":"Order Details")("showBackButton",!0)}}function V(o,a){if(1&o){const i=e.RV6();e.j41(0,"ion-modal",29),e.bIt("ionModalDidDismiss",function(){s.eBV(i);const t=e.XpG();return s.Njj(t.closeForm())}),e.DNE(1,U,4,2,"ng-template"),e.k0s()}}let Q=(()=>{var o;class a{constructor(r,t,n,l){this.alertController=r,this.navCtrl=t,this.orderService=n,this.operationsService=l,this.orders=[],this.formMode=null,this.selectedOrder=null,this.showForm=!1,this.currentPage=1,this.hasMore=!0,this.loading=!1,this.searchQuery="",this.searchSubject=new O.B,this.destroy$=new O.B,this.searchSubject.pipe((0,v.B)(300),(0,F.F)(),(0,x.Q)(this.destroy$)).subscribe(m=>{this.performSearch(m)})}ngOnInit(){console.log("Order Management Component Initialized"),this.loadOrders()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.searchSubject.complete()}loadOrders(r){this.loading||!this.hasMore||(this.loading=!0,this.orderService.getOrders(this.currentPage,10,this.searchQuery).subscribe({next:t=>{this.orders=1===this.currentPage?t.items:[...this.orders,...t.items],this.hasMore=t.paging.currentPage<t.paging.totalPages,this.currentPage++,this.loading=!1,r&&r.target.complete()},error:t=>{console.error("Error loading orders:",t),this.loading=!1,r&&r.target.complete()}}))}onSearchInput(r){const t=r.target.value||"";this.searchQuery=t,this.searchSubject.next(t)}performSearch(r){this.searchQuery=r,this.currentPage=1,this.hasMore=!0,this.orders=[],this.loadOrders()}clearSearch(){this.searchQuery="",this.searchInput&&(this.searchInput.value=""),this.performSearch("")}openCreateForm(){this.selectedOrder=null,this.formMode="create",this.showForm=!0}openReadForm(r){this.orderService.getOrder(r.orderIdSeq).subscribe({next:t=>{this.selectedOrder=t,this.formMode="read",this.showForm=!0},error:t=>{console.error("Error loading order details:",t)}})}openUpdateForm(r){this.orderService.getOrder(r.orderIdSeq).subscribe({next:t=>{this.selectedOrder=t,this.formMode="update",this.showForm=!0},error:t=>{console.error("Error loading order details:",t)}})}confirmDelete(r){var t=this;return(0,k.A)(function*(){yield(yield t.alertController.create({header:"Confirm Delete",message:`Are you sure you want to delete order "${r.orderName}"?`,buttons:[{text:"Cancel",role:"cancel"},{text:"Delete",handler:()=>{t.deleteOrder(r)}}]})).present()})()}deleteOrder(r){this.orderService.deleteOrder(r.orderIdSeq).subscribe({next:()=>{this.orders=this.orders.filter(t=>t.orderIdSeq!==r.orderIdSeq),console.log("Order deleted successfully")},error:t=>{console.error("Error deleting order:",t)}})}handleFormSubmit(r){"create"===this.formMode?this.orderService.createOrder(r).subscribe({next:t=>{this.orders.unshift(t),this.closeForm(),console.log("Order created successfully")},error:t=>{console.error("Error creating order:",t)}}):"update"===this.formMode&&this.selectedOrder&&this.orderService.updateOrder(this.selectedOrder.orderIdSeq,r).subscribe({next:t=>{const n=this.orders.findIndex(l=>l.orderIdSeq===this.selectedOrder?.orderIdSeq);n>-1&&(this.orders[n]=t),this.closeForm(),console.log("Order updated successfully")},error:t=>{console.error("Error updating order:",t)}}),this.closeForm()}closeForm(){this.showForm=!1,this.selectedOrder=null,this.formMode=null}onHeaderBackClick(){console.log("Header back button clicked - navigating back"),this.operationsService.navigateToOperations()}static#e=o=()=>(this.\u0275fac=function(t){return new(t||a)(e.rXU(c.hG),e.rXU(I.q9),e.rXU($),e.rXU(S.A))},this.\u0275cmp=e.VBU({type:a,selectors:[["app-order-management"]],viewQuery:function(t,n){if(1&t&&e.GBs(B,5),2&t){let l;e.mGM(l=e.lsd())&&(n.searchInput=l.first)}},standalone:!1,decls:20,vars:7,consts:[["searchInput",""],["backAction","back","rightIconColor","primary",3,"backClicked","rightButtonClicked","showBackButton"],[1,"page-header"],[1,"page-title-container"],[1,"page-title"],[1,"page-subtitle"],["fill","solid","color","primary",1,"add-button",3,"click"],["slot","start","name","add-outline"],[1,"search-card"],["placeholder","Search by order name, ID, or buyer...","debounce","0",3,"keyup","ionClear","value"],["class","results-info",4,"ngIf"],[4,"ngIf"],["class","empty-state",4,"ngIf"],[3,"ionInfinite","disabled"],["loadingSpinner","bubbles","loadingText","Loading more orders..."],["isOpen","true",3,"ionModalDidDismiss",4,"ngIf"],[1,"results-info"],["class","order-item",4,"ngFor","ngForOf"],[1,"order-item"],[3,"click"],[3,"color"],[1,"details"],[1,"pricing"],["slot","end"],["color","secondary",3,"click"],["slot","icon-only","name","create-outline"],["color","danger",3,"click"],["slot","icon-only","name","trash-outline"],[1,"empty-state"],["isOpen","true",3,"ionModalDidDismiss"],["backAction","dismiss",3,"backClicked","title","showBackButton"]],template:function(t,n){if(1&t){const l=e.RV6();e.j41(0,"app-header",1),e.bIt("backClicked",function(){return s.eBV(l),s.Njj(n.onHeaderBackClick())})("rightButtonClicked",function(){return s.eBV(l),s.Njj(n.openCreateForm())}),e.k0s(),e.j41(1,"ion-content")(2,"div",2)(3,"div",3)(4,"h1",4),e.EFF(5,"Orders"),e.k0s(),e.j41(6,"p",5),e.EFF(7,"Manage customer orders"),e.k0s()(),e.j41(8,"ion-button",6),e.bIt("click",function(){return s.eBV(l),s.Njj(n.openCreateForm())}),e.nrm(9,"ion-icon",7),e.EFF(10," Add "),e.k0s()(),e.j41(11,"ion-card",8)(12,"ion-searchbar",9,0),e.bIt("keyup",function(g){return s.eBV(l),s.Njj(n.onSearchInput(g))})("ionClear",function(){return s.eBV(l),s.Njj(n.clearSearch())}),e.k0s()(),e.DNE(14,R,6,1,"ion-item",10)(15,T,2,1,"ion-list",11)(16,D,7,2,"ion-card",12),e.j41(17,"ion-infinite-scroll",13),e.bIt("ionInfinite",function(g){return s.eBV(l),s.Njj(n.loadOrders(g))}),e.nrm(18,"ion-infinite-scroll-content",14),e.k0s(),e.DNE(19,V,2,0,"ion-modal",15),e.k0s()}2&t&&(e.Y8G("showBackButton",!0),e.R7$(12),e.Y8G("value",n.searchQuery),e.R7$(2),e.Y8G("ngIf",n.searchQuery),e.R7$(),e.Y8G("ngIf",n.orders.length>0),e.R7$(),e.Y8G("ngIf",0===n.orders.length&&!n.loading),e.R7$(),e.Y8G("disabled",!n.hasMore),e.R7$(2),e.Y8G("ngIf",n.showForm))},dependencies:[u.Sq,u.bT,c.In,c.Jm,c.QW,c.b_,c.I9,c.ME,c.tN,c.W9,c.iq,c.Ax,c.Hp,c.uz,c.he,c.nf,c.S1,c.Sb,c.Gw,C.l,u.vh],styles:[".page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px;background:var(--ion-color-light);border-bottom:1px solid var(--ion-color-medium)}.page-title-container[_ngcontent-%COMP%]{flex:1}.page-title[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;font-weight:600;color:var(--ion-color-dark)}.page-subtitle[_ngcontent-%COMP%]{margin:4px 0 0;font-size:.9rem;color:var(--ion-color-medium-shade)}.add-button[_ngcontent-%COMP%]{--border-radius: 8px;height:40px;font-weight:500}.search-card[_ngcontent-%COMP%]{margin:16px 16px 8px;border-radius:12px;box-shadow:0 2px 8px #0000001a}.search-card[_ngcontent-%COMP%]   ion-searchbar[_ngcontent-%COMP%]{--background: transparent;--border-radius: 8px;padding:4px}.results-info[_ngcontent-%COMP%]{--background: var(--ion-color-light);--color: var(--ion-color-medium-shade);font-size:.9rem;margin:0 16px 8px;border-radius:8px}.order-item[_ngcontent-%COMP%]{margin:8px 16px;border-radius:12px;--background: var(--ion-color-light);box-shadow:0 2px 8px #00000014;--border-color: transparent}.order-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{cursor:pointer;padding:8px 0}.order-item[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;margin-bottom:8px;color:var(--ion-color-dark)}.order-item[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%], .order-item[_ngcontent-%COMP%]   .pricing[_ngcontent-%COMP%]{font-size:.9rem;color:var(--ion-color-medium-shade);margin:4px 0}.order-item[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]{font-size:.75rem;margin-left:8px}.empty-state[_ngcontent-%COMP%]{margin:32px 16px;text-align:center;border-radius:12px;box-shadow:0 2px 8px #0000001a}.empty-state[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{color:var(--ion-color-medium-shade);font-size:1.2rem}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium);margin:8px 0}ion-button[_ngcontent-%COMP%]{--border-radius: 8px}@media (max-width: 768px){.page-header[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;gap:12px}.add-button[_ngcontent-%COMP%]{width:100%}}"]}))}return o(),a})(),X=(()=>{var o;class a{static#e=o=()=>(this.\u0275fac=function(t){return new(t||a)},this.\u0275mod=e.$C({type:a}),this.\u0275inj=s.G2t({providers:[c.hG],imports:[u.MD,c.bv,_.X1,C.l,_.YN,M.iI.forChild([{path:"",component:Q}])]}))}return o(),a})()}}]);