"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9342],{9342:(Y,v,s)=>{s.r(v),s.d(v,{InvoiceManagementModule:()=>X});var l=s(7343),u=s(2200),M=s(4341),f=s(385),_=s(8132),b=s(467),I=s(1413),k=s(9584),F=s(3294),j=s(6977),e=s(3664),c=s(2615),x=s(5035),C=s(9330),p=s(8810),h=s(9437),y=s(5312),P=s(8938),$=s(3067);let B=(()=>{var o;class r{constructor(t,n){this.http=t,this.loginService=n,this.API_URL=`${y.c.apiBaseUrl}/invoice`}getHeaders(){const t=this.loginService.getToken();return new C.Lr({"Content-Type":"application/json",Authorization:`Bearer ${t}`})}getInvoices(t=1,n=P.R.TEN,i){let m=`${this.API_URL}?page=${t}&itemsPerPage=${n}`;return i&&i.trim()&&(m+=`&search=${encodeURIComponent(i.trim())}`),this.http.get(m,{headers:this.getHeaders()}).pipe((0,h.W)(d=>(0,p.$)(()=>d)))}getInvoice(t){return this.http.get(`${this.API_URL}/${t}`,{headers:this.getHeaders()}).pipe((0,h.W)(n=>(0,p.$)(()=>n)))}createInvoice(t){return this.http.post(this.API_URL,t,{headers:this.getHeaders()}).pipe((0,h.W)(n=>(0,p.$)(()=>n)))}updateInvoice(t,n){return this.http.put(`${this.API_URL}/${t}`,n,{headers:this.getHeaders()}).pipe((0,h.W)(i=>(0,p.$)(()=>i)))}deleteInvoice(t){return this.http.delete(`${this.API_URL}/${t}`,{headers:this.getHeaders()}).pipe((0,h.W)(n=>(0,p.$)(()=>n)))}static#e=o=()=>(this.\u0275fac=function(n){return new(n||r)(c.KVO(C.Qq),c.KVO($.H))},this.\u0275prov=c.jDH({token:r,factory:r.\u0275fac,providedIn:"root"}))}return o(),r})();var O=s(6568);const R=["searchInput"];function T(o,r){if(1&o&&(e.j41(0,"ion-item",16)(1,"ion-label"),e.EFF(2," Found "),e.j41(3,"strong"),e.EFF(4),e.k0s(),e.EFF(5," invoice(s) "),e.k0s()()),2&o){const a=e.XpG();e.R7$(4),e.JRh(a.invoices.length)}}function E(o,r){if(1&o){const a=e.RV6();e.j41(0,"ion-item",18)(1,"ion-label",19),e.bIt("click",function(){const n=c.eBV(a).$implicit,i=e.XpG(2);return c.Njj(i.openReadForm(n))}),e.j41(2,"h2"),e.EFF(3),e.j41(4,"ion-badge",20),e.EFF(5),e.k0s()(),e.j41(6,"p",21),e.EFF(7,"Buyer: "),e.j41(8,"strong"),e.EFF(9),e.k0s(),e.EFF(10," | Date: "),e.j41(11,"strong"),e.EFF(12),e.nI1(13,"date"),e.k0s()(),e.j41(14,"p",22),e.EFF(15),e.k0s()(),e.j41(16,"ion-buttons",23)(17,"ion-button",24),e.bIt("click",function(){const n=c.eBV(a).$implicit,i=e.XpG(2);return c.Njj(i.openUpdateForm(n))}),e.nrm(18,"ion-icon",25),e.k0s(),e.j41(19,"ion-button",26),e.bIt("click",function(){const n=c.eBV(a).$implicit,i=e.XpG(2);return c.Njj(i.confirmDelete(n))}),e.nrm(20,"ion-icon",27),e.k0s()()()}if(2&o){const a=r.$implicit;e.R7$(3),e.SpI("",a.invoiceId," "),e.R7$(2),e.SpI("#",a.compId),e.R7$(4),e.JRh(a.buyrId),e.R7$(3),e.JRh(e.i5U(13,7,a.invoiceDate,"short")),e.R7$(3),e.E5c("Product: ",a.prodId," | Quantity: ",a.quantity," | Amount: \u20b9",a.totalAmount)}}function S(o,r){if(1&o&&(e.j41(0,"ion-list"),e.DNE(1,E,21,10,"ion-item",17),e.k0s()),2&o){const a=e.XpG();e.R7$(),e.Y8G("ngForOf",a.invoices)}}function G(o,r){if(1&o&&(e.j41(0,"p"),e.EFF(1),e.k0s()),2&o){const a=e.XpG(2);e.R7$(),e.SpI('No invoices match your search "',a.searchQuery,'"')}}function D(o,r){1&o&&(e.j41(0,"p"),e.EFF(1,"No invoices available. Click the add button to create one."),e.k0s())}function N(o,r){if(1&o&&(e.j41(0,"ion-card",28)(1,"ion-card-header")(2,"ion-card-title"),e.EFF(3,"No Invoices Found"),e.k0s()(),e.j41(4,"ion-card-content"),e.DNE(5,G,2,1,"p",11)(6,D,2,0,"p",11),e.k0s()()),2&o){const a=e.XpG();e.R7$(5),e.Y8G("ngIf",a.searchQuery),e.R7$(),e.Y8G("ngIf",!a.searchQuery&&0===a.invoices.length)}}function U(o,r){if(1&o){const a=e.RV6();e.j41(0,"app-header",30),e.bIt("backClicked",function(){c.eBV(a);const n=e.XpG(2);return c.Njj(n.closeForm())}),e.k0s(),e.j41(1,"ion-content")(2,"p"),e.EFF(3,"Invoice Form - To be implemented"),e.k0s()()}if(2&o){const a=e.XpG(2);e.Y8G("title","create"===a.formMode?"Create Invoice":"update"===a.formMode?"Update Invoice":"Invoice Details")("showBackButton",!0)}}function V(o,r){if(1&o){const a=e.RV6();e.j41(0,"ion-modal",29),e.bIt("ionModalDidDismiss",function(){c.eBV(a);const n=e.XpG();return c.Njj(n.closeForm())}),e.DNE(1,U,4,2,"ng-template"),e.k0s()}}const A=[{path:"",component:(()=>{var o;class r{constructor(t,n,i,m){this.alertController=t,this.navController=n,this.invoiceService=i,this.operationsService=m,this.invoices=[],this.formMode=null,this.selectedInvoice=null,this.showForm=!1,this.currentPage=1,this.hasMore=!0,this.loading=!1,this.searchQuery="",this.searchSubject=new I.B,this.destroy$=new I.B}ngOnInit(){this.loadInvoices(),this.setupSearch()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}setupSearch(){this.searchSubject.pipe((0,k.B)(300),(0,F.F)(),(0,j.Q)(this.destroy$)).subscribe(t=>{this.searchQuery=t,this.currentPage=1,this.invoices=[],this.hasMore=!0,this.loadInvoices()})}loadInvoices(t){this.loading||(this.loading=!0,this.invoiceService.getInvoices(this.currentPage,10,this.searchQuery).subscribe({next:n=>{this.invoices=1===this.currentPage?n.items:[...this.invoices,...n.items],this.hasMore=this.currentPage<n.paging.totalPages,this.currentPage++,this.loading=!1,t&&t.target.complete()},error:n=>{console.error("Error loading invoices:",n),this.loading=!1,t&&t.target.complete()}}))}onSearchInput(t){this.searchSubject.next(t.target.value||"")}clearSearch(){this.searchSubject.next("")}onHeaderBackClick(){this.operationsService.navigateToOperations()}openCreateForm(){this.formMode="create",this.selectedInvoice=null,this.showForm=!0}openReadForm(t){this.formMode="read",this.selectedInvoice=t,this.showForm=!0}openUpdateForm(t){this.formMode="update",this.selectedInvoice=t,this.showForm=!0}closeForm(){this.showForm=!1,this.formMode=null,this.selectedInvoice=null}confirmDelete(t){var n=this;return(0,b.A)(function*(){yield(yield n.alertController.create({header:"Confirm Delete",message:`Are you sure you want to delete invoice ${t.invoiceId}?`,buttons:[{text:"Cancel",role:"cancel"},{text:"Delete",role:"destructive",handler:()=>{n.deleteInvoice(t)}}]})).present()})()}deleteInvoice(t){this.invoiceService.deleteInvoice(t.invoiceSeq).subscribe({next:()=>{this.invoices=this.invoices.filter(n=>n.invoiceSeq!==t.invoiceSeq)},error:n=>{console.error("Error deleting invoice:",n)}})}static#e=o=()=>(this.\u0275fac=function(n){return new(n||r)(e.rXU(l.hG),e.rXU(x.q9),e.rXU(B),e.rXU(O.A))},this.\u0275cmp=e.VBU({type:r,selectors:[["app-invoice-management"]],viewQuery:function(n,i){if(1&n&&e.GBs(R,5),2&n){let m;e.mGM(m=e.lsd())&&(i.searchInput=m.first)}},standalone:!1,decls:20,vars:7,consts:[["searchInput",""],["backAction","back","rightIconColor","primary",3,"backClicked","rightButtonClicked","showBackButton"],[1,"page-header"],[1,"page-title-container"],[1,"page-title"],[1,"page-subtitle"],["fill","solid","color","primary",1,"add-button",3,"click"],["slot","start","name","add-outline"],[1,"search-card"],["placeholder","Search by invoice ID, company, or buyer...","debounce","0",3,"keyup","ionClear","value"],["class","results-info",4,"ngIf"],[4,"ngIf"],["class","empty-state",4,"ngIf"],[3,"ionInfinite","disabled"],["loadingSpinner","bubbles","loadingText","Loading more invoices..."],["isOpen","true",3,"ionModalDidDismiss",4,"ngIf"],[1,"results-info"],["class","invoice-item",4,"ngFor","ngForOf"],[1,"invoice-item"],[3,"click"],["color","primary"],[1,"details"],[1,"amount"],["slot","end"],["color","secondary",3,"click"],["slot","icon-only","name","create-outline"],["color","danger",3,"click"],["slot","icon-only","name","trash-outline"],[1,"empty-state"],["isOpen","true",3,"ionModalDidDismiss"],["backAction","dismiss",3,"backClicked","title","showBackButton"]],template:function(n,i){if(1&n){const m=e.RV6();e.j41(0,"app-header",1),e.bIt("backClicked",function(){return c.eBV(m),c.Njj(i.onHeaderBackClick())})("rightButtonClicked",function(){return c.eBV(m),c.Njj(i.openCreateForm())}),e.k0s(),e.j41(1,"ion-content")(2,"div",2)(3,"div",3)(4,"h1",4),e.EFF(5,"Invoices"),e.k0s(),e.j41(6,"p",5),e.EFF(7,"Manage invoice records"),e.k0s()(),e.j41(8,"ion-button",6),e.bIt("click",function(){return c.eBV(m),c.Njj(i.openCreateForm())}),e.nrm(9,"ion-icon",7),e.EFF(10," Add "),e.k0s()(),e.j41(11,"ion-card",8)(12,"ion-searchbar",9,0),e.bIt("keyup",function(g){return c.eBV(m),c.Njj(i.onSearchInput(g))})("ionClear",function(){return c.eBV(m),c.Njj(i.clearSearch())}),e.k0s()(),e.DNE(14,T,6,1,"ion-item",10)(15,S,2,1,"ion-list",11)(16,N,7,2,"ion-card",12),e.j41(17,"ion-infinite-scroll",13),e.bIt("ionInfinite",function(g){return c.eBV(m),c.Njj(i.loadInvoices(g))}),e.nrm(18,"ion-infinite-scroll-content",14),e.k0s(),e.DNE(19,V,2,0,"ion-modal",15),e.k0s()}2&n&&(e.Y8G("showBackButton",!0),e.R7$(12),e.Y8G("value",i.searchQuery),e.R7$(2),e.Y8G("ngIf",i.searchQuery),e.R7$(),e.Y8G("ngIf",i.invoices.length>0),e.R7$(),e.Y8G("ngIf",0===i.invoices.length&&!i.loading),e.R7$(),e.Y8G("disabled",!i.hasMore),e.R7$(2),e.Y8G("ngIf",i.showForm))},dependencies:[l.In,l.Jm,l.QW,l.b_,l.I9,l.ME,l.tN,l.W9,l.iq,l.Ax,l.Hp,l.uz,l.he,l.nf,l.S1,l.Sb,l.Gw,u.Sq,u.bT,f.l,u.vh],styles:[".page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px;background:var(--ion-color-light);border-bottom:1px solid var(--ion-color-medium)}.page-title-container[_ngcontent-%COMP%]{flex:1}.page-title[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;font-weight:600;color:var(--ion-color-dark)}.page-subtitle[_ngcontent-%COMP%]{margin:4px 0 0;font-size:.9rem;color:var(--ion-color-medium-shade)}.add-button[_ngcontent-%COMP%]{--border-radius: 8px;height:40px;font-weight:500}.search-card[_ngcontent-%COMP%]{margin:16px 16px 8px;border-radius:12px;box-shadow:0 2px 8px #0000001a}.search-card[_ngcontent-%COMP%]   ion-searchbar[_ngcontent-%COMP%]{--background: transparent;--border-radius: 8px;padding:4px}.results-info[_ngcontent-%COMP%]{--background: var(--ion-color-light);--color: var(--ion-color-medium-shade);font-size:.9rem;margin:0 16px 8px;border-radius:8px}.invoice-item[_ngcontent-%COMP%]{margin:8px 16px;border-radius:12px;--background: var(--ion-color-light);box-shadow:0 2px 8px #00000014;--border-color: transparent}.invoice-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{cursor:pointer;padding:8px 0}.invoice-item[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;margin-bottom:8px;color:var(--ion-color-dark)}.invoice-item[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%], .invoice-item[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-size:.9rem;color:var(--ion-color-medium-shade);margin:4px 0}.invoice-item[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]{font-size:.75rem;margin-left:8px}.empty-state[_ngcontent-%COMP%]{margin:32px 16px;text-align:center;border-radius:12px;box-shadow:0 2px 8px #0000001a}.empty-state[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{color:var(--ion-color-medium-shade);font-size:1.2rem}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium);margin:8px 0}ion-button[_ngcontent-%COMP%]{--border-radius: 8px}@media (max-width: 768px){.page-header[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;gap:12px}.add-button[_ngcontent-%COMP%]{width:100%}}"]}))}return o(),r})()}];let Q=(()=>{var o;class r{static#e=o=()=>(this.\u0275fac=function(n){return new(n||r)},this.\u0275mod=e.$C({type:r}),this.\u0275inj=c.G2t({imports:[_.iI.forChild(A),_.iI]}))}return o(),r})(),X=(()=>{var o;class r{static#e=o=()=>(this.\u0275fac=function(n){return new(n||r)},this.\u0275mod=e.$C({type:r}),this.\u0275inj=c.G2t({imports:[l.bv,u.MD,M.YN,f.l,Q]}))}return o(),r})()}}]);