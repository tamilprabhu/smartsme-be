"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5943],{5943:(A,f,c)=>{c.r(f),c.d(f,{DispatchManagementModule:()=>X});var u=c(2200),h=c(7343),_=c(4341),M=c(8132),k=c(467),C=c(1413),v=c(9584),F=c(3294),I=c(6977),t=c(3664),a=c(2615),x=c(5035),D=c(9330),d=c(8810),m=c(9437),j=c(5312),y=c(8938),P=c(3067);let $=(()=>{var o;class r{constructor(n,e){this.http=n,this.loginService=e,this.API_URL=`${j.c.apiBaseUrl}/dispatch`}getHeaders(){const n=this.loginService.getToken();return new D.Lr({"Content-Type":"application/json",Authorization:`Bearer ${n}`})}getDispatches(n=1,e=y.R.TEN,i){let p=`${this.API_URL}?page=${n}&itemsPerPage=${e}`;return i&&i.trim()&&(p+=`&search=${encodeURIComponent(i.trim())}`),this.http.get(p,{headers:this.getHeaders()}).pipe((0,m.W)(l=>(0,d.$)(()=>l)))}getDispatch(n){return this.http.get(`${this.API_URL}/${n}`,{headers:this.getHeaders()}).pipe((0,m.W)(e=>(0,d.$)(()=>e)))}createDispatch(n){return this.http.post(this.API_URL,n,{headers:this.getHeaders()}).pipe((0,m.W)(e=>(0,d.$)(()=>e)))}updateDispatch(n,e){return this.http.put(`${this.API_URL}/${n}`,e,{headers:this.getHeaders()}).pipe((0,m.W)(i=>(0,d.$)(()=>i)))}deleteDispatch(n){return this.http.delete(`${this.API_URL}/${n}`,{headers:this.getHeaders()}).pipe((0,m.W)(e=>(0,d.$)(()=>e)))}static#t=o=()=>(this.\u0275fac=function(e){return new(e||r)(a.KVO(D.Qq),a.KVO(P.H))},this.\u0275prov=a.jDH({token:r,factory:r.\u0275fac,providedIn:"root"}))}return o(),r})();var S=c(6568),b=c(385);const O=["searchInput"];function B(o,r){if(1&o&&(t.j41(0,"ion-item",16)(1,"ion-label"),t.EFF(2," Found "),t.j41(3,"strong"),t.EFF(4),t.k0s(),t.EFF(5," dispatch(es) "),t.k0s()()),2&o){const s=t.XpG();t.R7$(4),t.JRh(s.dispatches.length)}}function E(o,r){if(1&o){const s=t.RV6();t.j41(0,"ion-item",18)(1,"ion-label",19),t.bIt("click",function(){const e=a.eBV(s).$implicit,i=t.XpG(2);return a.Njj(i.openReadForm(e))}),t.j41(2,"h2"),t.EFF(3),t.j41(4,"ion-badge",20),t.EFF(5),t.k0s()(),t.j41(6,"p",21),t.EFF(7,"Product: "),t.j41(8,"strong"),t.EFF(9),t.k0s(),t.EFF(10," | Date: "),t.j41(11,"strong"),t.EFF(12),t.nI1(13,"date"),t.k0s()(),t.j41(14,"p",22),t.EFF(15),t.k0s()(),t.j41(16,"ion-buttons",23)(17,"ion-button",24),t.bIt("click",function(){const e=a.eBV(s).$implicit,i=t.XpG(2);return a.Njj(i.openUpdateForm(e))}),t.nrm(18,"ion-icon",25),t.k0s(),t.j41(19,"ion-button",26),t.bIt("click",function(){const e=a.eBV(s).$implicit,i=t.XpG(2);return a.Njj(i.confirmDelete(e))}),t.nrm(20,"ion-icon",27),t.k0s()()()}if(2&o){const s=r.$implicit;t.R7$(3),t.SpI("",s.dispatchId," "),t.R7$(2),t.SpI("#",s.orderId),t.R7$(4),t.JRh(s.prodId),t.R7$(3),t.JRh(t.i5U(13,7,s.dispatchDate,"short")),t.R7$(3),t.E5c("Quantity: ",s.quantity," | Packs: ",s.noOfPacks," | Weight: ",s.totalWeight,"kg")}}function R(o,r){if(1&o&&(t.j41(0,"ion-list"),t.DNE(1,E,21,10,"ion-item",17),t.k0s()),2&o){const s=t.XpG();t.R7$(),t.Y8G("ngForOf",s.dispatches)}}function T(o,r){if(1&o&&(t.j41(0,"p"),t.EFF(1),t.k0s()),2&o){const s=t.XpG(2);t.R7$(),t.SpI('No dispatches match your search "',s.searchQuery,'"')}}function G(o,r){1&o&&(t.j41(0,"p"),t.EFF(1,"No dispatches available. Click the add button to create one."),t.k0s())}function N(o,r){if(1&o&&(t.j41(0,"ion-card",28)(1,"ion-card-header")(2,"ion-card-title"),t.EFF(3,"No Dispatches Found"),t.k0s()(),t.j41(4,"ion-card-content"),t.DNE(5,T,2,1,"p",11)(6,G,2,0,"p",11),t.k0s()()),2&o){const s=t.XpG();t.R7$(5),t.Y8G("ngIf",s.searchQuery),t.R7$(),t.Y8G("ngIf",!s.searchQuery&&0===s.dispatches.length)}}function U(o,r){if(1&o){const s=t.RV6();t.j41(0,"app-header",30),t.bIt("backClicked",function(){a.eBV(s);const e=t.XpG(2);return a.Njj(e.closeForm())}),t.k0s(),t.j41(1,"ion-content")(2,"p"),t.EFF(3,"Dispatch Form - To be implemented"),t.k0s()()}if(2&o){const s=t.XpG(2);t.Y8G("title","create"===s.formMode?"Create Dispatch":"update"===s.formMode?"Update Dispatch":"Dispatch Details")("showBackButton",!0)}}function V(o,r){if(1&o){const s=t.RV6();t.j41(0,"ion-modal",29),t.bIt("ionModalDidDismiss",function(){a.eBV(s);const e=t.XpG();return a.Njj(e.closeForm())}),t.DNE(1,U,4,2,"ng-template"),t.k0s()}}let Q=(()=>{var o;class r{constructor(n,e,i,p){this.alertController=n,this.navCtrl=e,this.dispatchService=i,this.operationsService=p,this.dispatches=[],this.formMode=null,this.selectedDispatch=null,this.showForm=!1,this.currentPage=1,this.hasMore=!0,this.loading=!1,this.searchQuery="",this.searchSubject=new C.B,this.destroy$=new C.B,this.searchSubject.pipe((0,v.B)(300),(0,F.F)(),(0,I.Q)(this.destroy$)).subscribe(l=>{this.performSearch(l)})}ngOnInit(){console.log("Dispatch Management Component Initialized"),this.loadDispatches()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.searchSubject.complete()}loadDispatches(n){this.loading||!this.hasMore||(this.loading=!0,this.dispatchService.getDispatches(this.currentPage,10,this.searchQuery).subscribe({next:e=>{this.dispatches=1===this.currentPage?e.items:[...this.dispatches,...e.items],this.hasMore=e.paging.currentPage<e.paging.totalPages,this.currentPage++,this.loading=!1,n&&n.target.complete()},error:e=>{console.error("Error loading dispatches:",e),this.loading=!1,n&&n.target.complete()}}))}onSearchInput(n){const e=n.target.value||"";this.searchQuery=e,this.searchSubject.next(e)}performSearch(n){this.searchQuery=n,this.currentPage=1,this.hasMore=!0,this.dispatches=[],this.loadDispatches()}clearSearch(){this.searchQuery="",this.searchInput&&(this.searchInput.value=""),this.performSearch("")}openCreateForm(){this.selectedDispatch=null,this.formMode="create",this.showForm=!0}openReadForm(n){this.dispatchService.getDispatch(n.dispatchIdSeq).subscribe({next:e=>{this.selectedDispatch=e,this.formMode="read",this.showForm=!0},error:e=>{console.error("Error loading dispatch details:",e)}})}openUpdateForm(n){this.dispatchService.getDispatch(n.dispatchIdSeq).subscribe({next:e=>{this.selectedDispatch=e,this.formMode="update",this.showForm=!0},error:e=>{console.error("Error loading dispatch details:",e)}})}confirmDelete(n){var e=this;return(0,k.A)(function*(){yield(yield e.alertController.create({header:"Confirm Delete",message:`Are you sure you want to delete dispatch "${n.dispatchId}"?`,buttons:[{text:"Cancel",role:"cancel"},{text:"Delete",handler:()=>{e.deleteDispatch(n)}}]})).present()})()}deleteDispatch(n){this.dispatchService.deleteDispatch(n.dispatchIdSeq).subscribe({next:()=>{this.dispatches=this.dispatches.filter(e=>e.dispatchIdSeq!==n.dispatchIdSeq),console.log("Dispatch deleted successfully")},error:e=>{console.error("Error deleting dispatch:",e)}})}handleFormSubmit(n){"create"===this.formMode?this.dispatchService.createDispatch(n).subscribe({next:e=>{this.dispatches.unshift(e),this.closeForm(),console.log("Dispatch created successfully")},error:e=>{console.error("Error creating dispatch:",e)}}):"update"===this.formMode&&this.selectedDispatch&&this.dispatchService.updateDispatch(this.selectedDispatch.dispatchIdSeq,n).subscribe({next:e=>{const i=this.dispatches.findIndex(p=>p.dispatchIdSeq===this.selectedDispatch?.dispatchIdSeq);i>-1&&(this.dispatches[i]=e),this.closeForm(),console.log("Dispatch updated successfully")},error:e=>{console.error("Error updating dispatch:",e)}}),this.closeForm()}closeForm(){this.showForm=!1,this.selectedDispatch=null,this.formMode=null}onHeaderBackClick(){console.log("Header back button clicked - navigating back"),this.operationsService.navigateToOperations()}static#t=o=()=>(this.\u0275fac=function(e){return new(e||r)(t.rXU(h.hG),t.rXU(x.q9),t.rXU($),t.rXU(S.A))},this.\u0275cmp=t.VBU({type:r,selectors:[["app-dispatch-management"]],viewQuery:function(e,i){if(1&e&&t.GBs(O,5),2&e){let p;t.mGM(p=t.lsd())&&(i.searchInput=p.first)}},standalone:!1,decls:20,vars:7,consts:[["searchInput",""],["backAction","back","rightIconColor","primary",3,"backClicked","rightButtonClicked","showBackButton"],[1,"page-header"],[1,"page-title-container"],[1,"page-title"],[1,"page-subtitle"],["fill","solid","color","primary",1,"add-button",3,"click"],["slot","start","name","add-outline"],[1,"search-card"],["placeholder","Search by dispatch ID, order, or product...","debounce","0",3,"keyup","ionClear","value"],["class","results-info",4,"ngIf"],[4,"ngIf"],["class","empty-state",4,"ngIf"],[3,"ionInfinite","disabled"],["loadingSpinner","bubbles","loadingText","Loading more dispatches..."],["isOpen","true",3,"ionModalDidDismiss",4,"ngIf"],[1,"results-info"],["class","dispatch-item",4,"ngFor","ngForOf"],[1,"dispatch-item"],[3,"click"],["color","primary"],[1,"details"],[1,"quantity"],["slot","end"],["color","secondary",3,"click"],["slot","icon-only","name","create-outline"],["color","danger",3,"click"],["slot","icon-only","name","trash-outline"],[1,"empty-state"],["isOpen","true",3,"ionModalDidDismiss"],["backAction","dismiss",3,"backClicked","title","showBackButton"]],template:function(e,i){if(1&e){const p=t.RV6();t.j41(0,"app-header",1),t.bIt("backClicked",function(){return a.eBV(p),a.Njj(i.onHeaderBackClick())})("rightButtonClicked",function(){return a.eBV(p),a.Njj(i.openCreateForm())}),t.k0s(),t.j41(1,"ion-content")(2,"div",2)(3,"div",3)(4,"h1",4),t.EFF(5,"Dispatches"),t.k0s(),t.j41(6,"p",5),t.EFF(7,"Manage dispatch records"),t.k0s()(),t.j41(8,"ion-button",6),t.bIt("click",function(){return a.eBV(p),a.Njj(i.openCreateForm())}),t.nrm(9,"ion-icon",7),t.EFF(10," Add "),t.k0s()(),t.j41(11,"ion-card",8)(12,"ion-searchbar",9,0),t.bIt("keyup",function(g){return a.eBV(p),a.Njj(i.onSearchInput(g))})("ionClear",function(){return a.eBV(p),a.Njj(i.clearSearch())}),t.k0s()(),t.DNE(14,B,6,1,"ion-item",10)(15,R,2,1,"ion-list",11)(16,N,7,2,"ion-card",12),t.j41(17,"ion-infinite-scroll",13),t.bIt("ionInfinite",function(g){return a.eBV(p),a.Njj(i.loadDispatches(g))}),t.nrm(18,"ion-infinite-scroll-content",14),t.k0s(),t.DNE(19,V,2,0,"ion-modal",15),t.k0s()}2&e&&(t.Y8G("showBackButton",!0),t.R7$(12),t.Y8G("value",i.searchQuery),t.R7$(2),t.Y8G("ngIf",i.searchQuery),t.R7$(),t.Y8G("ngIf",i.dispatches.length>0),t.R7$(),t.Y8G("ngIf",0===i.dispatches.length&&!i.loading),t.R7$(),t.Y8G("disabled",!i.hasMore),t.R7$(2),t.Y8G("ngIf",i.showForm))},dependencies:[u.Sq,u.bT,h.In,h.Jm,h.QW,h.b_,h.I9,h.ME,h.tN,h.W9,h.iq,h.Ax,h.Hp,h.uz,h.he,h.nf,h.S1,h.Sb,h.Gw,b.l,u.vh],styles:[".page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px;background:var(--ion-color-light);border-bottom:1px solid var(--ion-color-medium)}.page-title-container[_ngcontent-%COMP%]{flex:1}.page-title[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;font-weight:600;color:var(--ion-color-dark)}.page-subtitle[_ngcontent-%COMP%]{margin:4px 0 0;font-size:.9rem;color:var(--ion-color-medium-shade)}.add-button[_ngcontent-%COMP%]{--border-radius: 8px;height:40px;font-weight:500}.search-card[_ngcontent-%COMP%]{margin:16px 16px 8px;border-radius:12px;box-shadow:0 2px 8px #0000001a}.search-card[_ngcontent-%COMP%]   ion-searchbar[_ngcontent-%COMP%]{--background: transparent;--border-radius: 8px;padding:4px}.results-info[_ngcontent-%COMP%]{--background: var(--ion-color-light);--color: var(--ion-color-medium-shade);font-size:.9rem;margin:0 16px 8px;border-radius:8px}.dispatch-item[_ngcontent-%COMP%]{margin:8px 16px;border-radius:12px;--background: var(--ion-color-light);box-shadow:0 2px 8px #00000014;--border-color: transparent}.dispatch-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{cursor:pointer;padding:8px 0}.dispatch-item[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;margin-bottom:8px;color:var(--ion-color-dark)}.dispatch-item[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%], .dispatch-item[_ngcontent-%COMP%]   .quantity[_ngcontent-%COMP%]{font-size:.9rem;color:var(--ion-color-medium-shade);margin:4px 0}.dispatch-item[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]{font-size:.75rem;margin-left:8px}.empty-state[_ngcontent-%COMP%]{margin:32px 16px;text-align:center;border-radius:12px;box-shadow:0 2px 8px #0000001a}.empty-state[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{color:var(--ion-color-medium-shade);font-size:1.2rem}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium);margin:8px 0}ion-button[_ngcontent-%COMP%]{--border-radius: 8px}@media (max-width: 768px){.page-header[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;gap:12px}.add-button[_ngcontent-%COMP%]{width:100%}}"]}))}return o(),r})(),X=(()=>{var o;class r{static#t=o=()=>(this.\u0275fac=function(e){return new(e||r)},this.\u0275mod=t.$C({type:r}),this.\u0275inj=a.G2t({providers:[h.hG],imports:[u.MD,h.bv,_.X1,b.l,_.YN,M.iI.forChild([{path:"",component:Q}])]}))}return o(),r})()}}]);